library(apcluster)
cl1 <- cbind(rnorm(100, 0.2, 0.05), rnorm(100, 0.8, 0.06))
cl2 <- cbind(rnorm(100, 0.7, 0.08), rnorm(100, 0.3, 0.05))
x <- rbind(cl1, cl2)
## compute similarity matrix (negative squared Euclidean)
sim <- negDistMat(x, r=2)
wide_eff<-read.csv("leadrop_basemean.csv", row.names = 1)
View(wide_eff)
View(x)
cl1 <- cbind(rnorm(100, 0.2, 0.05), rnorm(100, 0.8, 0.06))
cl2 <- cbind(rnorm(50, 0.7, 0.08), rnorm(50, 0.3, 0.05))
x <- rbind(cl1, cl2)
## compute similarity matrix and run affinity propagation
## (p defaults to median of similarity)
apres <- apcluster(negDistMat(r=2), x, details=TRUE)
## show details of clustering results
show(apres)
## plot clustering result
plot(apres, x)
## plot heatmap
heatmap(apres)
apres <- apcluster(s=apres@sim, q=0.1)
show(apres)
plot(apres, x)
sim
?apcluster
apres <- apcluster(negDistMat(r=2), wide_eff, details=TRUE)
show(apres)
apres <- apcluster(s=apres@sim, q=0.1)
show(apres)
log2<-read.csv("leadrop_basemean.csv", row.names = 1)
View(sim)
sim <- expSimMat(wide_eff, r=2)
apres <- apcluster(s=sim, q=0.2)
show(apres)
sim <- expSimMat(wide_eff, r=2)
apres <- apcluster(s=sim, q=0.1)
show(apres)
log2<-read.csv("log2values.csv", row.names = 1)
sim <- expSimMat(log2, r=2)
apres <- apcluster(s=sim, q=0.1)
show(apres)
apres <- apcluster(s=sim, q=0.01)
show(apres)
sim <- expSimMat(log2, r=5)
apres <- apcluster(s=sim, q=0.1)
show(apres)
sim <- expSimMat(log2, r=10)
apres <- apcluster(s=sim, q=0.1)
show(apres)
?xpSimMat
?expSimMat
sim <- expSimMat(log2, r=2)
apres <- apcluster(s=sim, q=0.5)
show(apres)
sim <- expSimMat(log2, r=2)
apres <- apcluster(s=sim, q=1)
show(apres)
sim <- expSimMat(log2, r=2)
apres <- apcluster(s=sim, q=0.15)
show(apres)
sim <- expSimMat(log2, r=2)
apres <- apcluster(s=sim, q=0.1)
show(apres)
cl1 <- cbind(rnorm(150, 0.2, 0.05), rnorm(150, 0.8, 0.06))
cl2 <- cbind(rnorm(100, 0.7, 0.08), rnorm(100, 0.3, 0.05))
x <- rbind(cl1, cl2)
## leveraged apcluster
apres <- apclusterL(negDistMat(r=2), x, frac=0.2, sweeps=3, p=-0.2)
## show details of leveraged clustering results
show(apres)
## plot leveraged clustering result
plot(apres, x)
## plot heatmap of clustering result
heatmap(apres)
count<-read.csv("Mo_leafdrop_cutoff_10.csv")
sim <- expSimMat(count, r=2)
apres <- apcluster(s=sim, q=0.1)
show(apres)
count<-read.csv("Mo_leafdrop_cutoff_10.csv", row.names = 1)
sim <- expSimMat(count, r=2)
apres <- apcluster(s=sim, q=0.1)
show(apres)
sim <- expSimMat(count, r=2)
apres <- apcluster(s=sim, q=0.15)
show(apres)
sim <- expSimMat(count, r=1)
apres <- apcluster(s=sim, q=0.15)
show(apres)
sim <- expSimMat(count, r=1)
apres <- apcluster(s=sim, q=0.5)
show(apres)
sim <- expSimMat(count, r=4)
apres <- apcluster(s=sim, q=0.2)
show(apres)
?apcluster
apres <- apcluster(negDistMat(r=2), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.1)
show(apres)
apres <- apcluster(negDistMat(r=2), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.15)
show(apres)
apres <- apcluster(negDistMat(r=2), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.2)
show(apres)
apres <- apcluster(negDistMat(r=1), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.15)
show(apres)
apres <- apcluster(negDistMat(r=2), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.15)
show(apres)
apres <- apcluster(negDistMat(r=2), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.3)
show(apres)
apres <- apcluster(negDistMat(r=2), wide_eff, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.2)
show(apres)
apres <- apcluster(negDistMat(r=2), wide_eff, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.1)
show(apres)
apres <- apcluster(negDistMat(r=2), wide_eff, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.15)
show(apres)
apres <- apcluster(negDistMat(r=2), log2, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.15)
show(apres)
apres <- apclusterK(negDistMat(r=2), wide_eff, K=20)
## show details of clustering results
show(apres)
apres <- apclusterK(negDistMat(r=2), count, K=24)
## show details of clustering results
show(apres)
apres <- apclusterK(negDistMat(r=1), count, K=24)
## show details of clustering results
show(apres)
View(count)
apres <- apcluster(negDistMat(r=2), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.15)
show(apres)
apres <- apcluster(negDistMat(r=2), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.15)
show(apres)
apres <- apcluster(negDistMat(r=2), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.3)
show(apres)
apres <- apclusterK(negDistMat(r=2), count, K=20)
## show details of clustering results
show(apres)
apres <- apclusterK(negDistMat(r=2), wide_eff, K=20)
## show details of clustering results
show(apres)
apres <- apcluster(ssim, q=0)
apres
apres <- apcluster(negDistMat(r=1), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.15)
show(apres)
apres <- apcluster(negDistMat(r=1), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.1)
show(apres)
apres <- apcluster(negDistMat(r=1), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.2)
show(apres)
apres <- apcluster(negDistMat(r=1), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.3)
show(apres)
apres <- apcluster(negDistMat(r=2), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.3)
show(apres)
apres <- apcluster(negDistMat(r=5), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.3)
show(apres)
apres <- apcluster(negDistMat(r=1), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.3)
show(apres)
apres <- apcluster(negDistMat(r=1), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.5)
show(apres)
apres <- apcluster(negDistMat(r=1), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.4)
show(apres)
apres <- apcluster(negDistMat(r=1), wide_eff, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.3)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=1), wide_eff, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.4)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=1), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.4)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=2), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.4)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=4), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.4)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=1), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.4)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=0.5), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.15)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=0.5), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.4)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=0.75), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.3)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=0.65), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.2)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=0.55), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.2)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=0.55), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.9)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=0.55), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.2)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=0.55), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.5)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=0.55), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=1)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=0.55), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.01)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=0.55), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.1)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=0.55), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.5)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=0.55), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.3)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=0.35), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.3)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=0.5), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.3)#0.4)
show(apres)
apres <- apcluster(negDistMat(r=0.6), count, details=TRUE)
apres <- apcluster(s=apres@sim, q=0.3)#0.4)
show(apres)
library(dplyr)
library(tidyverse)
library(ggplot2)
leaf_drop<-read.csv("TPM_leafdrop/leafdrop.csv")
gene_length<-read.csv("TPM_leafdrop/gene_length_mo.csv")
leaf_len<-inner_join(leaf_drop, gene_length, by=c("Gene"="Gene.stable.ID"))
View(leaf_len)
leaf_drop<-read.csv("TPM_leafdrop/Mo_leafdrop.csv")
gene_length<-read.csv("TPM_leafdrop/gene_length_mo.csv")
leaf_len<-inner_join(leaf_drop, gene_length, by=c("Gene"="Gene.stable.ID"))
leaf_len<-inner_join(leaf_drop, gene_length, by=c("X"="Gene.stable.ID"))
write.csv(leaf_len, "leaf_len.csv")
co_spray<-read.csv("TPMs_spray/co39_spray.csv")
moukoto_spray<-read.csv("TPMs_spray/moukoto.csv")
co_spray_len<-inner_join(co_spray, gene_length, by=c("Gene"="Gene.stable.ID"))
mou_spray_len<-inner_join(moukoto_spray, gene_length, by=c("Gene"="Gene.stable.ID"))
co_spray_len<-inner_join(co_spray, gene_length, by=c("Gene"="Gene.stable.ID"))
mou_spray_len<-inner_join(moukoto_spray, gene_length, c=("X"="Gene.stable.ID"))
mou_spray_len<-inner_join(moukoto_spray, gene_length, by=c("X"="Gene.stable.ID"))
write.csv(co_spray_len, "co_spray_len.csv")
write.csv(cmou_spray_len, "mou_spray_len.csv")
write.csv(mou_spray_len, "mou_spray_len.csv")
