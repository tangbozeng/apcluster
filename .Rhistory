facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=6,  family="Arial"),
axis.text.y = element_text(color="black", size=6,  family="Arial"))
ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$genes,
color=long_eff_clu$names))+
geom_line()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=10,  family="Arial"))
ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$genes,
color=long_eff_clu$names))+
geom_line()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=10,  family="Arial"))+
scale_color_brewer(palette="Dark2")
ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$genes,
color=long_eff_clu$names))+
geom_line()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=10,  family="Arial"))
ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$genes,
color=long_eff_clu$names))+
geom_line()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=10,  family="Arial"))+
scale_color_brewer(palette="Spectral")
ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$genes,
color=long_eff_clu$names))+
geom_line()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=10,  family="Arial"))+
scale_colour_gradientn(colours=rainbow(4))
ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$genes,
color=long_eff_clu$names))+
geom_line()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=10,  family="Arial"))+
scale_colour_hue()
ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$genes,
color=long_eff_clu$names))+
geom_line()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=12,  family="Arial"))+
scale_colour_hue()
eff_cluster<-eff_ex%>%
mutate(hub_gene=labels(apres,type="names"))%>%
mutate(cluster=labels(apres, type="enum"))%>%# type can be exemplars as well
mutate(genes=rownames(eff_ex))%>%
group_by(cluster)%>%mutate(count = n())%>% # mutate new column with group number! nice!
filter(count>7)%>%# remove clusters with less than 5 genes
dplyr::mutate(names=paste(hub_gene, count,sep="_"))# create new labels
long_eff_clu<-eff_cluster%>%
pivot_longer(cols=t0:t144, values_to="expression", names_to="time_points")
long_eff_clu$time_points<-
ordered(long_eff_clu$time_points,
levels=c("t0","t8","t16","t24","t48","t72","t96","t144"))
ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$genes,
color=long_eff_clu$names))+
geom_line()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=12,  family="Arial"))+
scale_colour_hue()
ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$genes,
color=long_eff_clu$names))+
geom_line()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=10,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=12,  family="Arial"))+
scale_colour_hue()
ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$genes,
color=long_eff_clu$names))+
geom_line()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=12,  family="Arial"))+
scale_colour_hue()
?pivot_wider
?pivot_wider_spec
wide_clustered<-long_eff_clu%>%
pivot_wider_spec(names_from=time_points, values_from=expression)
wide_clustered<-long_eff_clu%>%
pivot_wider(names_from=time_points, values_from=expression)
View(wide_clustered)
write.csv(wide_clustered,"output.csv")
write.csv(wide_clustered,"output_apcluster.csv")
# install.packages('devtools')
devtools::install_github('thomasp85/gganimate')
library(gganimate)
install.packages(gifski)
devtools::install_github("r-rust/gifski")
library(gifski)
library(gganimate)
library(ggplot2)
ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$genes,
color=long_eff_clu$names))+
geom_line()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=12,  family="Arial"))+
scale_colour_hue()+
transition_time(long_eff_clu$time_points) +
ease_aes('linear')
long_eff_clu$time_points<-integer(long_eff_clu$time_points)
long_eff_clu$time_points<-as.integer(long_eff_clu$time_points)
View(long_eff_clu)
ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$genes,
color=long_eff_clu$names))+
geom_line()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=12,  family="Arial"))+
scale_colour_hue()+
transition_time(long_eff_clu$time_points) +
ease_aes('linear')
ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$genes,
color=long_eff_clu$names))+
geom_point()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=12,  family="Arial"))+
scale_colour_hue()+
transition_time(long_eff_clu$time_points) +
ease_aes('linear')
warnings()
devtools::install_github("thomasp85/transformr")
?anim_save
ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$genes,
color=long_eff_clu$names))+
geom_line()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=12,  family="Arial"))+
scale_colour_hue()+
transition_time(long_eff_clu$time_points) +
ease_aes('linear')
animate<-ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$genes,
color=long_eff_clu$names))+
geom_line(aes(group=long_eff_clu$genes))+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=12,  family="Arial"))+
scale_colour_hue()+
transition_time(long_eff_clu$time_points) +
ease_aes('linear')
animate(nanimate, fps = 10, width = 750, height = 450)
animate(animate, fps = 10, width = 750, height = 450)
animate<-ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$names))+
geom_line(aes(group=long_eff_clu$names,
color=long_eff_clu$names))+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=12,  family="Arial"))+
scale_colour_hue()
aniamte
animate
animate<-ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$names))+
geom_line()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=12,  family="Arial"))+
scale_colour_hue()+
transition_time(long_eff_clu$time_points) +
ease_aes('linear')
animate<-ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$names))+
geom_line()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=12,  family="Arial"))+
scale_colour_hue()
long_eff_clu$time_points<-as.numeric(long_eff_clu$time_points)
animate<-ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$names))+
geom_line()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=12,  family="Arial"))+
scale_colour_hue()+
transition_time(long_eff_clu$time_points) +
ease_aes('linear')
animate<-ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$names))+
geom_line()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=12,  family="Arial"))+
scale_colour_hue()
ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$names))+
geom_line()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=12,  family="Arial"))+
scale_colour_hue()
long_eff_clu<-eff_cluster%>%
pivot_longer(cols=t0:t144, values_to="expression", names_to="time_points")
long_eff_clu$time_points<-
ordered(long_eff_clu$time_points,
levels=c("t0","t8","t16","t24","t48","t72","t96","t144"))
# plot clusters
ggplot(data = long_eff_clu,
aes(x=long_eff_clu$time_points,
y=log2(long_eff_clu$expression),
group=long_eff_clu$genes,
color=long_eff_clu$names))+
geom_line()+
facet_wrap(~long_eff_clu$names, scales = "free")+
theme_classic()+
theme(strip.text = element_text(size=12,
color="black",
family="Arial"))+
ylab("relative transcript as TPMs")+
xlab("Time points")+
theme(legend.position = "none")+
theme(plot.title = element_text(color="black", size=20,  family="Arial"),
axis.title.x = element_text(color="black", size=20, family="Arial"),
axis.title.y = element_text(color="black", size=20, family="Arial"))+
theme(axis.text.x = element_text(color="black", size=8,  family="Arial"),
axis.text.y = element_text(color="black", size=12,  family="Arial"))+
scale_colour_hue()
library(dplyr)
library(tidyverse)
library(tidyverse)
remove.packages("tidyverse")
install.packages("tidyverse")
library(tidyverse)
